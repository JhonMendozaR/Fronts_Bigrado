<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Completar Registro - Bigrado</title>
    <link rel="stylesheet" href="/css/login.css">
    <link rel="icon" href="/img/Logo_Bigrado_negro.svg" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <meta name="description" content="Completa tu registro en Bigrado">
</head>
<body>


    <div class="onboarding-container">
        <div class="cards-container">
            <!-- Tarjeta 1: Información Personal -->
            <div class="onboarding-card active" id="card1">
                <div class="card-header">
                    <h2>Información Personal</h2>
                    <p>Cuéntanos un poco sobre ti</p>
                </div>

                <div class="progress-indicator">
                    <div class="progress-dot active"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                </div>

                <form id="personalForm" class="login-form">
                    <div class="register-group">
                        <select id="tipoIdentificacion" name="tipoIdentificacion" required>
                            <option value="">Tipo de identificación *</option>
                            <option value="cedula">Cédula de Ciudadanía</option>
                            <option value="tarjeta">Tarjeta de Identidad</option>
                            <option value="cedula_extranjeria">Cédula de Extranjería</option>
                            <option value="pasaporte">Pasaporte</option>
                        </select>
                    </div>

                    <div class="register-group">
                        <div class="input-container">
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="numeroIdentificacion" name="numeroIdentificacion" 
                                   placeholder="Número de identificación" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="register-group">
                            <div class="input-container">
                                <i class="fas fa-calendar"></i>
                                <input type="date" id="fechaNacimiento" name="fechaNacimiento" 
                                       placeholder="Fecha de nacimiento">
                            </div>
                        </div>
                        <div class="register-group">
                            <select id="genero" name="genero">
                                <option value="">Género</option>
                                <option value="masculino">Masculino</option>
                                <option value="femenino">Femenino</option>
                                <option value="otro">Otro</option>
                                <option value="prefiero_no_decir">Prefiero no decir</option>
                            </select>
                        </div>
                    </div>

                    <div class="register-group">
                        <div class="input-container">
                            <i class="fas fa-map-marker-alt"></i>
                            <input type="text" id="lugarNacimiento" name="lugarNacimiento" 
                                   placeholder="Lugar de nacimiento">
                        </div>
                    </div>

                    <div class="register-group">
                        <select id="nacionalidad" name="nacionalidad">
                            <option value="">Nacionalidad</option>
                            <option value="colombiana">Colombiana</option>
                            <option value="venezolana">Venezolana</option>
                            <option value="ecuatoriana">Ecuatoriana</option>
                            <option value="peruana">Peruana</option>
                            <option value="argentina">Argentina</option>
                            <option value="otra">Otra</option>
                        </select>
                    </div>

                    <div class="card-actions">
                        <button type="button" class="btn btn-outline" onclick="skipStep(1)">Omitir</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(1)">Siguiente</button>
                    </div>
                </form>
            </div>

            <!-- Tarjeta 2: Información de Contacto -->
            <div class="onboarding-card" id="card2">
                <div class="card-header">
                    <h2>Información de Contacto</h2>
                    <p>¿Dónde podemos encontrarte?</p>
                </div>

                <div class="progress-indicator">
                    <div class="progress-dot active"></div>
                    <div class="progress-dot active"></div>
                    <div class="progress-dot"></div>
                </div>

                <form id="contactForm" class="login-form">
                    <div class="register-group">
                        <div class="input-container">
                            <i class="fas fa-home"></i>
                            <input type="text" id="direccion" name="direccion" 
                                   placeholder="Dirección">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="register-group">
                            <div class="input-container">
                                <i class="fas fa-city"></i>
                                <input type="text" id="ciudad" name="ciudad" 
                                       placeholder="Ciudad">
                            </div>
                        </div>
                        <div class="register-group">
                            <select id="departamento" name="departamento">
                                <option value="">Departamento</option>
                                <option value="antioquia">Antioquia</option>
                                <option value="bogota">Bogotá D.C.</option>
                                <option value="valle">Valle del Cauca</option>
                                <option value="cundinamarca">Cundinamarca</option>
                                <option value="atlantico">Atlántico</option>
                                <option value="santander">Santander</option>
                                <option value="bolivar">Bolívar</option>
                                <option value="meta">Meta</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                    </div>

                    <div class="register-group">
                        <div class="input-container">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="correoContacto" name="correoContacto" 
                                   placeholder="Correo electrónico">
                        </div>
                    </div>

                    <div class="register-group">
                        <div class="input-container">
                            <i class="fas fa-phone"></i>
                            <input type="tel" id="telefono" name="telefono" 
                                   placeholder="Teléfono">
                        </div>
                    </div>

                    <div class="card-actions">
                        <button type="button" class="btn btn-outline" onclick="prevStep(2)">Atrás</button>
                        <button type="button" class="btn btn-outline" onclick="skipStep(2)">Omitir</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(2)">Siguiente</button>
                    </div>
                </form>
            </div>

            <!-- Tarjeta 3: Contacto de Emergencia -->
            <div class="onboarding-card" id="card3">
                <div class="card-header">
                    <h2>Contacto de Emergencia</h2>
                    <p>Información de tu contacto de emergencia</p>
                </div>

                <div class="progress-indicator">
                    <div class="progress-dot active"></div>
                    <div class="progress-dot active"></div>
                    <div class="progress-dot active"></div>
                </div>

                <form id="emergencyForm" class="login-form">
                    <div class="register-group">
                        <div class="input-container">
                            <i class="fas fa-user"></i>
                            <input type="text" id="nombreEmergencia" name="nombreEmergencia" 
                                   placeholder="Nombre completo">
                        </div>
                    </div>

                    <div class="register-group">
                        <select id="parentesco" name="parentesco">
                            <option value="">Parentesco</option>
                            <option value="padre">Padre</option>
                            <option value="madre">Madre</option>
                            <option value="hermano">Hermano/a</option>
                            <option value="conyuge">Cónyuge</option>
                            <option value="hijo">Hijo/a</option>
                            <option value="abuelo">Abuelo/a</option>
                            <option value="tio">Tío/a</option>
                            <option value="primo">Primo/a</option>
                            <option value="amigo">Amigo/a</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>

                    <div class="register-group">
                        <div class="input-container">
                            <i class="fas fa-phone-alt"></i>
                            <input type="tel" id="telefonoEmergencia" name="telefonoEmergencia" 
                                   placeholder="Teléfono de emergencia">
                        </div>
                    </div>

                    <div class="card-actions single-action">
                        <button type="button" class="btn btn-outline" onclick="prevStep(3)">Atrás</button>
                        <button type="button" class="btn btn-primary" onclick="finishOnboarding()">Finalizar registro</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="background-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
        </div>
    </div>

    <!-- Modal de éxito final -->
    <div id="finalModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2>¡Registro completado!</h2>
            <p>Tu perfil ha sido configurado exitosamente. Ahora puedes acceder a todas las funcionalidades de Bigrado.</p>
            <button onclick="redirectToDashboard()" class="success-btn">Ir al dashboard</button>
        </div>
    </div>

    <script>
        // Variables globales
        let currentStep = 1;
        const totalSteps = 3;



        // Función para ir al siguiente paso
        function nextStep(step) {
            if (validateCurrentStep(step)) {
                if (step < totalSteps) {
                    showCard(step + 1);
                }
            }
        }

        // Función para ir al paso anterior
        function prevStep(step) {
            if (step > 1) {
                showCard(step - 1);
            }
        }

        // Función para omitir paso
        function skipStep(step) {
            if (step < totalSteps) {
                showCard(step + 1);
            }
        }

        // Función para mostrar una tarjeta específica
        function showCard(cardNumber) {
            console.log('Showing card:', cardNumber); // Debug
            
            // Ocultar todas las tarjetas
            const cards = document.querySelectorAll('.onboarding-card');
            cards.forEach((card, index) => {
                card.classList.remove('active');
                if (index + 1 === cardNumber) {
                    card.classList.add('active');
                }
            });

            // Actualizar indicadores de progreso
            const dots = document.querySelectorAll('.progress-dot');
            dots.forEach((dot, index) => {
                if (index < cardNumber) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });

            currentStep = cardNumber;
        }

        // Función de validación básica
        function validateCurrentStep(step) {
            let isValid = true;
            const errorMessages = [];

            if (step === 1) {
                const tipoId = document.getElementById('tipoIdentificacion').value;
                const numeroId = document.getElementById('numeroIdentificacion').value;

                if (!tipoId) {
                    errorMessages.push('El tipo de identificación es obligatorio');
                    isValid = false;
                }

                if (!numeroId) {
                    errorMessages.push('El número de identificación es obligatorio');
                    isValid = false;
                }
            }

            if (!isValid) {
                alert(errorMessages.join('\n'));
            }

            return isValid;
        }

        // Función para finalizar el onboarding
        function finishOnboarding() {
            // Recopilar todos los datos del formulario
            const onboardingData = {
                // Información personal
                tipoIdentificacion: document.getElementById('tipoIdentificacion').value,
                numeroIdentificacion: document.getElementById('numeroIdentificacion').value,
                fechaNacimiento: document.getElementById('fechaNacimiento').value,
                lugarNacimiento: document.getElementById('lugarNacimiento').value,
                genero: document.getElementById('genero').value,
                nacionalidad: document.getElementById('nacionalidad').value,
                
                // Información de contacto
                direccion: document.getElementById('direccion').value,
                ciudad: document.getElementById('ciudad').value,
                departamento: document.getElementById('departamento').value,
                correoContacto: document.getElementById('correoContacto').value,
                telefono: document.getElementById('telefono').value,
                
                // Contacto de emergencia
                nombreEmergencia: document.getElementById('nombreEmergencia').value,
                parentesco: document.getElementById('parentesco').value,
                telefonoEmergencia: document.getElementById('telefonoEmergencia').value
            };

            // Guardar datos en localStorage (simulación)
            localStorage.setItem('onboardingData', JSON.stringify(onboardingData));

            // Mostrar modal de éxito
            document.getElementById('finalModal').style.display = 'flex';
        }

        // Función para redirigir al dashboard
        function redirectToDashboard() {
            // Redirigir a la página principal de la aplicación
            window.location.href = '/usuarios.html'; // Cambiar esta URL por la página de inicio o dashboard
        }

        // Navegación con teclado
        document.addEventListener('keydown', function(event) {
            if (event.key === 'ArrowLeft' && currentStep > 1) {
                prevStep(currentStep);
            } else if (event.key === 'ArrowRight' && currentStep < totalSteps) {
                nextStep(currentStep);
            }
        });

        // Soporte para gestos táctiles (básico)
        let startX = 0;
        let endX = 0;

        document.addEventListener('touchstart', function(event) {
            startX = event.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', function(event) {
            endX = event.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const threshold = 50; // Distancia mínima para considerar un swipe
            const diff = startX - endX;

            if (Math.abs(diff) > threshold) {
                if (diff > 0 && currentStep < totalSteps) {
                    // Swipe izquierda - siguiente
                    nextStep(currentStep);
                } else if (diff < 0 && currentStep > 1) {
                    // Swipe derecha - anterior
                    prevStep(currentStep);
                }
            }
        }

        // Inicialización cuando carga la página
        window.addEventListener('load', function() {
            // Asegurar que la primera tarjeta esté visible
            showCard(1);
        });
    </script>
</body>
</html>